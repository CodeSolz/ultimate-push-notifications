var firebaseConfig={apiKey:"AIzaSyB9dxOiphLW50FUcuP6oAcHnUzM8bTU-EU",authDomain:"ultimatepushnotification.firebaseapp.com",databaseURL:"https://ultimatepushnotification.firebaseio.com",projectId:"ultimatepushnotification",storageBucket:"ultimatepushnotification.appspot.com",messagingSenderId:"749894026214",appId:"1:749894026214:web:b1750a616f1c2acb990c27",measurementId:""};function createCookie(e,i){document.cookie=e+"="+i+";max-age=31536000"}function accessCookie(e){let i=e+"=",o=document.cookie.split(";");for(let e=0;e<o.length;e++){let n=o[e].trim();if(0==n.indexOf(i))return n.substring(i.length,n.length)}return""}firebase.initializeApp(firebaseConfig);const messaging=firebase.messaging();function sendTokenToServer(e){let i=new FormData;i.append("method","admin\\options\\functions\\AppConfig@cs_update_token"),i.append("gen_token",e),i.append("device_id",accessCookie("cs_wp_ultimate_device_id")),i.append("current_user",`${UPN_Notifier.current_user.user_id}`),fetch(`${UPN_Notifier.ajax_url}`,{method:"POST",body:i}).then(e=>e.json()).then(e=>{console.log(e)}).catch(function(e){console.log(e)})}navigator.serviceWorker.register(`${UPN_Notifier.asset_url}plugins/firebase/js/firebaseMessagingSW.min.js`).then(e=>{messaging.useServiceWorker(e),messaging.getToken().then(e=>{if(e)return accessCookie("cs_wp_ultimate_device_id")?sendTokenToServer(e):(createCookie("cs_wp_ultimate_device_id",`${e}`),sendTokenToServer(e)),e}).catch(e=>{console.log("An error occurred while retrieving token. ",e)}),messaging.onMessage(e=>{console.log("onMessage: ",e),window.Notification&&"denied"!==Notification.permission&&Notification.requestPermission(i=>{new Notification(e.notification.title,{body:e.notification.body,icon:e.notification.icon})})}),messaging.onTokenRefresh(()=>{messaging.getToken().then(e=>(sendTokenToServer(e),e)).catch(e=>{console.log("Unable to retrieve refreshed token ",e)})})});